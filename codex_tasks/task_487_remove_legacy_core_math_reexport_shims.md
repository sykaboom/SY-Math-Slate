# Task 487: Remove Legacy core/math Re-export Shim Files

Status: COMPLETED
Owner: Codex (spec / review / implementation)
Target: v10/
Date: 2026-02-22

---

## Goal (Base Required)
- What to change:
  - 사용 흔적이 없는 `v10/src/core/math/*.ts` re-export shim 파일 3개를 제거한다.
- What must NOT change:
  - `@core/math/*` alias (`tsconfig` -> `core/domain/math`)는 유지한다.
  - math 로더/렌더/규칙 동작은 변경하지 않는다.

---

## Scope (Base Required)

Touched files/directories:
- 삭제: `v10/src/core/math/loader.ts`
- 삭제: `v10/src/core/math/render.ts`
- 삭제: `v10/src/core/math/rules.ts`
- (필요 시) `v10/src/core/math/` 디렉터리 정리

Out of scope:
- `v10/src/core/domain/math/**` 로직 변경
- alias 경로 변경

---

## Dependencies / Constraints (Base Required)

- New dependencies allowed: NO
- Boundary rules:
  - core domain 구조/파일 이동 금지.
- Compatibility:
  - alias import 경로는 그대로 동작해야 한다.

---

## DAG / Wave Metadata (Base Required)

- Wave ID:
  - CW1
- Depends on tasks:
  - []
- Enables tasks:
  - []
- Parallel group:
  - G-cleanup-core
- Max parallel slots:
  - 6
- Verification stage for this task:
  - end

---

## Execution Mode Assessment (Base Required for new specs)

- Touched file count:
  - 1 directory / 3 files
- Files shared with other PENDING tasks:
  - none
- Cross-module dependency:
  - NO
- Parallelizable sub-units:
  - 0
- Estimated single-agent duration:
  - ~10min
- Recommended mode:
  - MANUAL
- Batch-eligible:
  - YES
  - If YES, mention ordering/file-lock constraints.
  - CW1 병렬 가능
- Rationale:
  - dead shim 정리 작업으로 범위가 작고 독립적이다.

---

## Optional Block A — Layout / SVG Gate

- [ ] Applies: NO

---

## Optional Block B — Delegated Execution

- [ ] Applies: NO
If NO:
- Execution mode: MANUAL

---

## Optional Block E — Documentation Update Check

- [x] Applies: YES
- [x] Structure changes (file/folder add/move/delete):
  - Run `node scripts/gen_ai_read_me_map.mjs`
  - Verify `v10/AI_READ_ME_MAP.md` update if needed
- [ ] Semantic/rule changes:
  - N/A (shim 제거)

---

## Acceptance Criteria (Base Required)

- [ ] AC-1: `v10/src/core/math/*.ts` shim 3개가 제거된다.
- [ ] AC-2: `@core/math/*` alias 기반 빌드가 정상 유지된다.
- [ ] AC-3: `scripts/check_layer_rules.sh` 통과.
- [ ] AC-4: `cd v10 && npm run lint && npm run build` 통과.
- [ ] AC-5: `node scripts/gen_ai_read_me_map.mjs` 실행 후 문서 동기화 상태가 유지된다.

---

## Manual Verification Steps (Base Required)

1) Step:
   - Command / click path:
    - `test ! -f v10/src/core/math/loader.ts && test ! -f v10/src/core/math/render.ts && test ! -f v10/src/core/math/rules.ts`
   - Expected result:
    - exit code 0
   - Covers: AC-1

2) Step:
   - Command / click path:
    - `scripts/check_layer_rules.sh`
   - Expected result:
    - PASS
   - Covers: AC-3

3) Step:
   - Command / click path:
    - `cd v10 && npm run lint && npm run build`
   - Expected result:
    - PASS
   - Covers: AC-2, AC-4

4) Step:
   - Command / click path:
    - `node scripts/gen_ai_read_me_map.mjs`
   - Expected result:
    - 명령 성공 + 문서 변경 필요 시 반영
   - Covers: AC-5

---

## Risks / Roll-back Notes (Base Required)

- Risks:
  - 숨은 상대경로 import가 있으면 빌드 실패 가능.
- Roll-back:
  - 3개 파일 복구 revert.

---

## Approval Gate (Base Required)

- [x] Spec self-reviewed by Codex
- [x] Explicit user approval received (or delegated chain approval reference)

> Implementation MUST NOT begin until both boxes are checked.

---

## Implementation Log (Codex fills)

Status: COMPLETED

Changed files:
- deleted `v10/src/core/math/loader.ts`
- deleted `v10/src/core/math/render.ts`
- deleted `v10/src/core/math/rules.ts`
- updated `v10/AI_READ_ME_MAP.md` (auto-generated by required command)
- updated `codex_tasks/task_487_remove_legacy_core_math_reexport_shims.md` (closeout section only)

Commands run (only if user asked or required by spec):
- `test ! -f v10/src/core/math/loader.ts && test ! -f v10/src/core/math/render.ts && test ! -f v10/src/core/math/rules.ts` (exit 0)
- `scripts/check_layer_rules.sh` -> `[check_layer_rules] PASS (no layer violations)`
- `cd v10 && npm run lint && npm run build` -> PASS
- `node scripts/gen_ai_read_me_map.mjs` -> `Wrote v10/AI_READ_ME_MAP.md`

## Gate Results (Codex fills)

- Lint:
  - PASS
- Build:
  - PASS
- Script checks:
  - `scripts/check_layer_rules.sh`: PASS
  - file deletion assertion command: PASS
  - `node scripts/gen_ai_read_me_map.mjs`: PASS

Manual verification notes:
- AC-1 PASS: 3개 shim 파일 미존재 확인 (assert command exit 0).
- AC-2 PASS: alias 유지 상태에서 `npm run build` 성공 (`tsconfig` 미수정).
- AC-3 PASS: layer rules PASS.
- AC-4 PASS: lint/build PASS.
- AC-5 PASS: 맵 재생성 명령 성공 및 구조 반영.

Notes:
- Failure classification: pre-existing/newly introduced, blocking/non-blocking 이슈 모두 없음.
- Hard constraint 준수: `@core/math` alias mapping 관련 설정(`tsconfig`) 변경 없음.
